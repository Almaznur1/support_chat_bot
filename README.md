# Чат-бот службы поддержки

Программа предназначена для реализации чат-бота службы поддержки в телеграм и vkontakte для ответа на частые вопросы пользователей при помощи нейросети DialogFlow.

Также скрипты отправляют сообщения администратору об ошибках через отдельный телеграм бот.

Состоит из двух основных скриптов для запуска ботов:
* tg_bot.py

![](/tg_bot.gif)

* vk_bot.py

![](/vk_bot.gif)

И нескольких вспомогательных скриптов:
* create_api_key.py
* create_intent.py
* dialog_flow.py

### Как установить

Python3 должен быть уже установлен.

Затем используйте `pip` (или `pip3`, если есть конфликт с Python2) для установки зависимостей:
```
pip install -r requirements.txt
```
### Перед запуском

* Создайте проект в [DialogFlow](https://dialogflow.cloud.google.com/#/login), получите project id

* Создайте агента [DialogFlow](https://cloud.google.com/dialogflow/docs/quick/build-agent)

* Установите [gcloud](https://cloud.google.com/dialogflow/es/docs/quick/setup#sdk), затем получите credentials.json

* Зарегистрируйте двух ботов (один для ответов на вопросы пользователей, другой для отправки логов об ошибках) в Telegram через [BotFather](https://t.me/BotFather)

* Узнайте ваш телеграм id [@userinfobot](https://t.me/userinfobot)

* Создайте сообщество [ВКонтакте](https://vk.com/groups), получите API в разделе управление и включите настройку "возможности ботов"

* Переименуйте файл *.env.example* в *.env* и занесите в него следующие данные:

```
TG_BOT_TOKEN=<токен чат-бота>
LOGGING_TG_BOT_TOKEN=<токен бота, который будет отправлять сообщения об ошибках администратору>
TG_USER_ID=<идентификатор телеграм аккаунта администратора>
PROJECT_ID=<google project id>
LANGUAGE_CODE=<код языка, который будет понимать DialogFlow (ru-RU - для русского языка)>
VK_API_KEY=<ключ API группы VK, в которой бот будет отвечать на вопросы пользователей>
DIALOG_FLOW_API_KEY_SUFFIX=<добавьте суффикс для уникальности ключа>
```
* Создайте токен от DialogFlow. Для этого запустите скрипт `create_api_key.py`:
```
python create_api_key.py
```
* Обучите DialogFlow. Для этого отредактируйте файл `questions.json` и занесите в него нужные вопросы и ответы:
```
{
    "Устройство на работу": {
        "questions": [
            "Как устроиться к вам на работу?",
            "Как устроиться к вам?",
            "Можно-ли мне поработать у вас?",
            "Хочу работать редактором у вас"
        ],
        "answer": ["Если вы хотите устроиться к нам, напишите на почту game-of-verbs@gmail.com мини-эссе о себе и прикрепите ваше портфолио."]
    },
}
```
* Запустите скрипт для тренировки DialogFlow:
```
python create_intent.py
```

### Запуск
Запустите оба скрипта через терминал

```
python tg_bot.py
python vk_bot.py
```

### Цель проекта

Код написан в образовательных целях на онлайн-курсе для веб-разработчиков [dvmn.org](https://dvmn.org/).